<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>WittyShare: The FileSystemTree, MenuTree and AccessTree</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WittyShare
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">The FileSystemTree, MenuTree and AccessTree </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>The FileSystemTree</h3>
<p>The core of wittyshare is the <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a>. This tree represents the files hierarchy on disk. When the application starts, it will scan all the directories starting from [root_path] and builds the tree. It will also search for config files for each directory and parse them. The main advantage of this solution is the speed. The FsTree will be stored in memory for fast access. This tree does not takes permissions in account because it does not represent any user, it will only be used to generate other trees.</p>
<p>It uses the <a class="el" href="classWsDirectoryCrawler.html" title="Abstract class used to crawl a directory. ">WsDirectoryCrawler</a> class to crawl over the directories. The <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a> inherits form the <a class="el" href="classWsDirectoryCrawler.html" title="Abstract class used to crawl a directory. ">WsDirectoryCrawler</a> and each time a dir is found, it calls the virtual method <a class="el" href="classWsFileSystemTree.html#a23a17c87d29829c4ca684b5c08b7ce67" title="this method is called by browse when the boost::filesystem::path is a folder ">WsFileSystemTree::applyDirectory()</a> which is overriden in <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a> class. This method creates a new Node and adds it to the current node and the current node is set to this node. The same is done for <a class="el" href="classWsFileSystemTree.html#aaa17d6e70043492d57dacd565b921166" title="this method is called by browse when the boost::filesystem::path is a file ">WsFileSystemTree::applyFile()</a>, but the current node is not changed.(we dont crawl deeper because it's a file). When all the subdirs of a directory are crawled, the <a class="el" href="classWsDirectoryCrawler.html" title="Abstract class used to crawl a directory. ">WsDirectoryCrawler</a> class calls the <a class="el" href="classWsFileSystemTree.html#ab7af76723ce2c2557f8e4303b39a0b4c" title="this method is called when finished browsing the subdir ">WsFileSystemTree::endChild()</a> method to notify the subclass so it can set the current node to the current.parent()</p>
<p>Each node has an properties (<a class="el" href="classWsNodeProperties.html" title="Properties of a WsNode. ">WsNodeProperties</a>) object attached by the <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a> that contains the properties of the node. The properties are parsed from the $NODE_PATH/.config/properties.json for the directories or $NODE_PATH/.config/nodes/$FILENAME.json for the nodes. It is not mandatory for a node to have a config file. The access rights for a node can also depend from the parent (see the inherit_rights_from_parent property). Each node also has the method isAllowed taking a list of groups that will return true if at least one of the groups has access. The FileNode checks access against its containing directory. The DirNode checks if it has a properties object setting groups. If yes, it checks against these groups. It not, it does up to the parent and goes through the same procedure.</p>
<p>Each node has an properties object attached by the <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a>. Each <a class="el" href="classWsNode.html" title="Represents a node on disk. ">WsNode</a> also has the method isAllowed taking a list of groups that will return true if at least one of the groups has access. The <a class="el" href="classWsFileNode.html" title="Reprensents a File on disk. ">WsFileNode</a> checks access against its containing directory. The DirNode checks if it has a properties object setting groups. If yes, it checks against these groups. It not, it does up to the parent and goes through the same procedure is the inherit_from_parent is ste to true in the configuration of the node or in the WsGlobalConfiguration.</p>
<h3>The MenuTree</h3>
<p>The <a class="el" href="classWsMenuTree.html" title="Reprensents a MenuTree. ">WsMenuTree</a> is used to build the menu of the application. The MenuTree is created from the <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a> tree by crawling over it and applying the following rules:</p>
<ul>
<li>If the user does not have access to the node</li>
<li>If the Node property [in_menu] is set to false</li>
<li>If the Node property [in_parent] is set to false<ul>
<li>skip the node and all children of the node,</li>
</ul>
</li>
<li>If the [max_menu_depth] is reached<ul>
<li>End crawling and return the MenuTree</li>
</ul>
</li>
</ul>
<p>The <a class="el" href="classWsMenuTree.html" title="Reprensents a MenuTree. ">WsMenuTree</a> class inherit from <a class="el" href="classWsAbstractTree.html" title="Abstract class representing an WsAccessTree or WsMenuTree. ">WsAbstractTree</a>, builds the menu of a user based on a the <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a> representing all the files on the server and a set of gids, which are the names of the groups where the user belongs.</p>
<p>The <a class="el" href="classWsAbstractTree.html" title="Abstract class representing an WsAccessTree or WsMenuTree. ">WsAbstractTree</a> class inherits from the <a class="el" href="classWsTreeTraversal.html" title="Used to traverse the tree. ">WsTreeTraversal</a> class that runs through the <a class="el" href="classWsFileSystemTree.html" title="Represents the file structure on disk. ">WsFileSystemTree</a> and, for each <a class="el" href="classWsNode.html" title="Represents a node on disk. ">WsNode</a> found, it calls a virtual function overridden in the child class. The <a class="el" href="classWsAbstractTree.html" title="Abstract class representing an WsAccessTree or WsMenuTree. ">WsAbstractTree</a> class tests for each Node if the user is allowed to access it or no. If the user is allowed, a new Node is created whith the same Properties, but without any children. The new Node is added to the MenuTree. If the user does not have access, the Node and all its children are skipped.</p>
<p>The <a class="el" href="classWsAbstractTree.html" title="Abstract class representing an WsAccessTree or WsMenuTree. ">WsAbstractTree</a> class contains 3 overriden functions of the parent class which are:</p>
<ul>
<li><a class="el" href="classWsAbstractTree.html#abdbf1a3fb31ae269faad707560503740" title="Called when a directory is being traversed. ">WsAbstractTree::beginTraverseDir</a></li>
<li><a class="el" href="classWsAbstractTree.html#a55dd0368c14cb8c7170d8baf7b83fecb" title="Called when traversing a fileNode. ">WsAbstractTree::traverseFile</a></li>
</ul>
<p><a class="el" href="classWsAbstractTree.html#abdbf1a3fb31ae269faad707560503740" title="Called when a directory is being traversed. ">WsAbstractTree::beginTraverseDir</a> is called by the <a class="el" href="classWsTreeTraversal.html" title="Used to traverse the tree. ">WsTreeTraversal</a> each time a <a class="el" href="classWsDirNode.html" title="Reprensents a Directory on disk. ">WsDirNode</a> is found. It Creates the new Node with the properties, connects the current Node to this new Node and sets the new Node as the current Node.</p>
<p><a class="el" href="classWsAbstractTree.html#a5d046f3b670c3f47467d17d3ee20ba06" title="Called when a directory has been completely traversed. ie all subnodes(recursively all sub nodes of s...">WsAbstractTree::endTraverseDir</a> is called by the <a class="el" href="classWsTreeTraversal.html" title="Used to traverse the tree. ">WsTreeTraversal</a> each time the <a class="el" href="classWsTreeTraversal.html" title="Used to traverse the tree. ">WsTreeTraversal</a> finish to browse a <a class="el" href="classWsDirNode.html" title="Reprensents a Directory on disk. ">WsDirNode</a> and all its children. It sets the current Node as the Parent of the current Node.</p>
<p><a class="el" href="classWsAbstractTree.html#a55dd0368c14cb8c7170d8baf7b83fecb" title="Called when traversing a fileNode. ">WsAbstractTree::traverseFile</a> is called by the <a class="el" href="classWsTreeTraversal.html" title="Used to traverse the tree. ">WsTreeTraversal</a> each time a <a class="el" href="classWsFileNode.html" title="Reprensents a File on disk. ">WsFileNode</a> is found. it does the same things as <a class="el" href="classWsAbstractTree.html#abdbf1a3fb31ae269faad707560503740" title="Called when a directory is being traversed. ">WsAbstractTree::beginTraverseDir</a> but creates a <a class="el" href="classWsFileNode.html" title="Reprensents a File on disk. ">WsFileNode</a> instead of a <a class="el" href="classWsDirNode.html" title="Reprensents a Directory on disk. ">WsDirNode</a>. The current Node is not changed.</p>
<p>Requests to the WsFilesystemtree are sent thanks to an <a class="el" href="classWsAbstractFsClient.html" title="Abstract Interface between the WsUser class and the operation on the tree. ">WsAbstractFsClient</a> that allows multiple implementations (at time of writing: daemon and in object directly)</p>
<h3>The AccessTree</h3>
<p>The <a class="el" href="classWsAccessTree.html" title="Reprensents an access tree. ">WsAccessTree</a> is the same as the <a class="el" href="classWsMenuTree.html" title="Reprensents a MenuTree. ">WsMenuTree</a> but does not take in consideration the [in_menu], [in_parent], [max_menu_depth] properties. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 20 2013 11:53:04 for WittyShare by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
